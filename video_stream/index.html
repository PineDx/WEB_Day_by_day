<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>视频流媒体</title>
    <style>
      body{
        margin: 0;
        padding: 0;
      }
      .box{
        width: 700px;
        height: 550px;
        background: #333;
        margin: 50px auto 0;
        box-shadow: 3px 5px 30px rgba(0, 0, 0, 0.5);
      }
      .title{
        width: 100%;
        height: 50px;
        background-color: #fff;
        text-align: center;
      }
      .content{
        width: 100%;
        height: 550px;
      }
      video{
        object-fit: fill;
      }
    </style>
  </head>
  <body>
      <div class="box">
        <div class="title">
          <h1>编写视频流Demo</h1>
        </div>
        <div class="content">
            <video width="100%" height="100%" autoplay poster="11.jpg"></video>
        </div>
        <div class="control">

        </div>
      </div>
      <script type="text/javascript">
      // MediaDevices.getUserMedia() 会提示用户给予使用媒体输入的许可，
      // 媒体输入会产生一个MediaStream，里面包含了请求的媒体类型的轨道。此流
      // 可以包含一个视频轨道（来自硬件或者虚拟视频源，比如相机、视频采集设备和
      // 屏幕共享服务等等）、一个音频轨道（同样来自硬件或虚拟音频源，比如麦克风
      // 、A / D转换器等等），也可能是其它轨道类型。
      //   它返回一个 Promise 对象，成功后会resolve回调一个 MediaStream 对象。
      //   若用户拒绝了使用权限，或者需要的媒体源不可用，promise会reject回调一个 
      //    PermissionDeniedError 或者 NotFoundError 。

      // navigator.mediaDevices.getUserMedia(constraints)
      //     .then(function (stream) {
      //       /* 使用这个stream stream */
      //     })
      //     .catch(function (err) {
      //       /* 处理error */
      //     });
        
      // {
      //     audio: true,
      //       video: { width: 1280, height: 720 }  指定输出分辨率
      //   }
      var constraints = {video:true}; 
        navigator.mediaDevices.getUserMedia(constraints)
        .then(function(mediaStream){
          var video = document.querySelector('video');
          video.srcObject = mediaStream;
          video.onloadedmetadata = function(){
            video.play();
          }
        })
        .catch(function(err){
            alert(err)
        });
      </script>
  </body>
</html>
